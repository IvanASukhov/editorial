{% extends "base.html" %}
{% block title %}Отчёты и аналитика — Админка{% endblock %}

{% block content %}
<h2>Отчёты и аналитика</h2>

<div style="margin-bottom: 16px;">
    <a href="{{ url_for('routes.admin_reports_export_csv') }}" class="btn btn-primary">
        Выгрузить отчёт по рукописям (CSV)
    </a>
</div>

<div class="reports-grid">

    <div class="report-card">
        <h3>Статистика пользователей</h3>
        <ul>
            <li>Всего пользователей: <b>{{ stats.users_total or 0 }}</b></li>
            <li>Авторы: <b>{{ stats.users_authors or 0 }}</b></li>
            <li>Редакторы: <b>{{ stats.users_staff or 0 }}</b></li>
            <li>Рецензенты: <b>{{ stats.users_reviewers or 0 }}</b></li>
            <li>Администраторы: <b>{{ stats.users_admins or 0 }}</b></li>
        </ul>
    </div>

    <div class="report-card">
        <h3>Публикации и рукописи</h3>
        <ul>
            <li>Всего публикаций: <b>{{ stats.publications_total or 0 }}</b></li>
            <li>Всего рукописей: <b>{{ stats.manuscripts_total or 0 }}</b></li>
            <li>Опубликовано статей: <b>{{ stats.published_manuscripts or 0 }}</b></li>
            <li>В процессе рассмотрения: <b>{{ stats.in_review or 0 }}</b></li>
        </ul>
    </div>

    <div class="report-card">
        <h3>Обращения пользователей</h3>
        <ul>
            <li>Всего обращений: <b>{{ stats.contacts_total or 0 }}</b></li>
            <li>Не обработано: <b>{{ stats.contacts_new or 0 }}</b></li>
            <li>Обработано: <b>{{ stats.contacts_done or 0 }}</b></li>
        </ul>
    </div>

    <div class="report-card">
        <h3>Динамика публикаций по годам</h3>
        <!-- Можно подключить график, например через Chart.js -->
        <div id="pubs_chart" style="min-height: 140px; background: #f8f8f8; border: 1px dashed #bbb; text-align: center; padding-top:40px;">
            <span style="color:#aaa;">[Тут будет график]</span>
        </div>
    </div>

</div>

<style>
.reports-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 32px 20px;
}
.report-card {
    min-width: 270px;
    background: #f8fafc;
    border: 1.5px solid #d7e3f0;
    border-radius: 6px;
    box-shadow: 0 1px 6px rgba(180,195,225,0.07);
    padding: 22px 22px 16px 22px;
    margin-bottom: 14px;
    flex: 1 1 340px;
}
.report-card h3 {
    font-size: 1.11em;
    margin-top: 0;
    color: #425c7c;
    margin-bottom: 12px;
}
</style>

{% endblock %}
